# golden_scent_chatbot
Doc2vec+LSA based chatbot assistant: recommends based on mood/occasion/timing of day,etc. 


Optimal Chatbot Interface for GoldenScent

I created a chatbot interface in a python notebook using a model that ensembles Doc2Vec and Latent Semantic Analysis(LSA). The Doc2Vec and LSA represent the perfumes and the text query in latent space, and cosine similarity is then used to match the perfumes to the text query. The top five most relevant perfumes are returned as recommendations. Here is an example interaction with the chatbot. A simple query for a Christmas scent returns five seasonally-appropriate perfumes. The first perfume for this request has the very on-topic note of myrrh!

The Model

The first step in the model is to identify the sentiment of each sentence from the chatbot message. I used VADER to do this. (It was super easy to use, and gave me great results. I highly recommend trying it out if you have a project where you’d like to use sentiment analysis.) I concatenate all positive and neutral sentences into one string, and all negative sentiment sentences into another string. I now have two documents I can use to find similar perfumes. The perfumes have text descriptions, reviews, and a list of notes. The model consists of two document embeddings, one from LSA and the other from Doc2Vev. To train the LSA and Doc2Vec models, I concatenated perfume descriptions, reviews, and notes into one document per perfume. I then use cosine similarity to find perfumes that are similar to the positive and neutral sentences from the chatbot message query. I remove recommendations of perfumes that are similar to the negative sentences. To calculate cosine similarity between the chatbot message and perfume documents, I calculate cosine similarity from the LSA embedding and the Doc2Vec embeddings separately, and then averaged the both scores to come up with a final score.

LSA simply tokenizer the words in a document with TF-IDF, and then compressed these features into embeddings with SVD. LSA is a Bag of Words(BoW) approach, meaning that the order (context) of the words used are not taken into account. This is the drawback of BoW approaches. However, I have seen many BoW approaches outperform more complex deep learning methods in practice, so LSA should still be tested and considered as a viable approach. Doc2Vec is a neural network approach to learning embeddings from a text document. Because of its architecture, this model considers context and semantics within the document. The context of the document and relationships between words are preserved in the learned embedding. By ensembeling the Doc2Vec with the LSA, I was able to get great 1–1 matchings such as returning rose perfumes when I ask for it, and I was also able to leverage the complexities of the language and return relevant results when I describe something more abstract such as a mood or event.

Conclusion If you’d like to try out the model and get some personalized recommendations, you can text the live bot at (424)343-3755. The chatbot is deployed using Flask, Twilio Programmable SMS, Airtable, and AWS EC2 instances. The code is also available on my public github repo.
